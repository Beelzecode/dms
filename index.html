<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dark Master Store - Premium Shopping</title>
    <link rel="manifest" href__="manifest.json">
    <meta name="theme-color" content="#fbbf24">
    <link rel="icon" href__="https://i.postimg.cc/gJhjVfvM/Logo-for-Dark-Master-Store.png" type="image/png">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.paypal.com/sdk/js?client-id=AZklnsqcDPchhxRGQp4Xs6o3UEkYwQARJe12w5SYrOE2g2Cfagu-h-P7Gd3VaJt-RXDHftuxhdu5oNxi"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif; }
        
        .product-card { transition: all 0.3s; cursor: pointer; }
        .product-card:hover { transform: translateY(-8px); box-shadow: 0 20px 40px rgba(0,0,0,0.15); }
        .category-card { transition: all 0.3s; cursor: pointer; }
        .category-card:hover { transform: translateY(-8px); box-shadow: 0 20px 40px rgba(0,0,0,0.15); }
        
        .combo-image-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: 2px;
            width: 100%;
            height: 100%;
        }
        .combo-image-grid img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .image-preview-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); 
            gap: 16px; 
            margin-top: 16px; 
        }
        .image-preview-item { 
            position: relative; 
            aspect-ratio: 1; 
            border-radius: 16px; 
            overflow: hidden; 
            border: 3px solid #fbbf24; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.15); 
        }
        .image-preview-img { width: 100%; height: 100%; object-fit: cover; }
        .image-preview-remove { 
            position: absolute; 
            top: 6px; 
            right: 6px; 
            background: #ef4444; 
            color: white; 
            border: none; 
            border-radius: 50%; 
            width: 32px; 
            height: 32px; 
            cursor: pointer; 
            font-size: 20px; 
            font-weight: bold; 
        }
        .image-preview-remove:hover { background: #dc2626; }
        
        .spinner { 
            width: 80px; 
            height: 80px; 
            border: 6px solid rgba(255,255,255,0.3); 
            border-top-color: #000; 
            border-radius: 50%; 
            animation: spin 1s linear infinite; 
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        
        .btn-primary { 
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); 
            color: #000; 
            font-weight: 700; 
            padding: 16px 32px; 
            border-radius: 12px; 
            border: none; 
            cursor: pointer; 
            transition: all 0.3s; 
            box-shadow: 0 4px 12px rgba(251,191,36,0.4); 
        }
        .btn-primary:hover:not(:disabled) { 
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); 
            transform: translateY(-2px); 
        }
        .btn-primary:disabled { opacity: 0.6; cursor: not-allowed; }
        
        .upload-btn-wrapper {
            position: relative;
            overflow: hidden;
            display: block;
            width: 100%;
        }
        .upload-btn {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            font-weight: 700;
            padding: 24px;
            border-radius: 12px;
            border: 3px dashed #60a5fa;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }
        .upload-btn:hover {
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.4);
        }
        .upload-btn-wrapper input[type=file] {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            cursor: pointer;
            width: 100%;
            height: 100%;
        }
        
        .toggle-switch {
            position: relative;
            width: 60px;
            height: 30px;
            background: #ccc;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .toggle-switch.active { background: #fbbf24; }
        .toggle-switch::after {
            content: '';
            position: absolute;
            top: 3px;
            left: 3px;
            width: 24px;
            height: 24px;
            background: white;
            border-radius: 50%;
            transition: all 0.3s;
        }
        .toggle-switch.active::after { left: 33px; }
        
        .products-table { width: 100%; border-collapse: collapse; }
        .products-table th { background: #f9fafb; padding: 16px; text-align: left; font-weight: 700; border-bottom: 2px solid #e5e7eb; }
        .products-table td { padding: 16px; border-bottom: 1px solid #e5e7eb; vertical-align: middle; }
        .products-table tr:hover { background: #f9fafb; }
        
        .banner-slide { animation: bannerFade 0.5s ease-in-out; }
        @keyframes bannerFade {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .order-status-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }
        .status-pending { background: #fef3c7; color: #92400e; }
        .status-processing { background: #dbeafe; color: #1e40af; }
        .status-shipped { background: #e0e7ff; color: #4338ca; }
        .status-delivered { background: #d1fae5; color: #065f46; }
        .status-cancelled { background: #fee2e2; color: #991b1b; }
        
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.7);
            z-index: 9999;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .modal-overlay.active { display: flex; }
        .modal-content {
            background: white;
            border-radius: 24px;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
        }
        
        .code-block {
            background: #1e293b;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 12px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            overflow-x: auto;
            position: relative;
            max-height: 500px;
        }
        .copy-code-btn {
            position: absolute;
            top: 12px;
            right: 12px;
            background: #fbbf24;
            color: black;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 12px;
        }
        .copy-code-btn:hover { background: #f59e0b; }
    </style>
</head>
<body class="bg-gray-50">
    
    <!-- AUTH MODAL -->
    <div id="authModal" class="modal-overlay">
        <div class="modal-content">
            <div class="p-8">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-bold" id="authModalTitle">Sign In</h2>
                    <button onclick="closeAuthModal()" class="p-2 hover:bg-gray-100 rounded-full">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
                
                <div id="authFormContainer">
                    <form id="loginForm" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Email</label>
                            <input type="email" required name="email" class="w-full px-4 py-3 border rounded-lg" placeholder="your@email.com" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Password</label>
                            <input type="password" required name="password" class="w-full px-4 py-3 border rounded-lg" placeholder="Enter password" />
                        </div>
                        <p id="authError" class="hidden text-red-500 text-sm bg-red-50 p-3 rounded-lg"></p>
                        <button type="submit" class="w-full bg-yellow-400 text-black font-bold py-3 rounded-lg hover:bg-yellow-500">
                            Sign In
                        </button>
                    </form>
                    
                    <form id="registerForm" class="space-y-4 hidden">
                        <div>
                            <label class="block text-sm font-medium mb-2">Full Name</label>
                            <input type="text" required name="fullName" class="w-full px-4 py-3 border rounded-lg" placeholder="Your full name" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Email</label>
                            <input type="email" required name="email" class="w-full px-4 py-3 border rounded-lg" placeholder="your@email.com" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Password</label>
                            <input type="password" required name="password" class="w-full px-4 py-3 border rounded-lg" placeholder="Min 6 characters" minlength="6" />
                        </div>
                        <p id="registerError" class="hidden text-red-500 text-sm bg-red-50 p-3 rounded-lg"></p>
                        <button type="submit" class="w-full bg-yellow-400 text-black font-bold py-3 rounded-lg hover:bg-yellow-500">
                            Create Account
                        </button>
                    </form>
                </div>
                
                <div class="mt-6 text-center">
                    <p class="text-sm text-gray-600">
                        <span id="authSwitchText">Don't have an account?</span>
                        <button onclick="toggleAuthMode()" class="text-yellow-600 font-semibold hover:text-yellow-700" id="authSwitchBtn">
                            Sign Up
                        </button>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- ADMIN LOGIN POPUP -->
    <div id="adminLoginPopup" class="hidden fixed inset-0 bg-yellow-400 z-50 flex items-center justify-center">
        <div class="bg-white rounded-3xl shadow-2xl p-12 w-full max-w-md mx-4 text-center">
            <div class="w-20 h-20 bg-yellow-400 rounded-full flex items-center justify-center mx-auto mb-6">
                <svg class="w-10 h-10 text-black" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z"/>
                </svg>
            </div>
            <h2 class="text-3xl font-bold mb-3">Admin Login</h2>
            <p class="text-gray-600 mb-8">Enter your password</p>
            
            <input 
                type="password"
                id="adminPasswordInput"
                placeholder="Admin Password"
                class="w-full px-4 py-4 border-2 border-gray-300 rounded-xl text-lg focus:outline-none focus:border-yellow-400 mb-6"
                onkeypress="if(event.key==='Enter') attemptAdminLogin()"
            />
            
            <p id="adminLoginError" class="hidden text-red-500 text-sm mb-4 bg-red-50 p-3 rounded-lg"></p>
            
            <button onclick="attemptAdminLogin()" class="w-full bg-black text-white font-bold py-4 rounded-xl text-lg hover:bg-gray-800 transition mb-3">
                Login
            </button>
            
            <button onclick="document.getElementById('adminLoginPopup').classList.add('hidden')" class="w-full bg-gray-200 text-gray-700 font-bold py-3 rounded-xl hover:bg-gray-300 transition">
                Cancel
            </button>
        </div>
    </div>

    <!-- MAIN STORE -->
    <div id="mainStore">
        <!-- Header -->
        <div class="bg-red-500 text-white text-center py-2 px-4 text-sm font-bold">
            ðŸ”¥ Free delivery on anything that you buy
        </div>
        
        <div class="bg-yellow-400 px-4 py-4 sticky top-0 z-40 shadow-lg">
            <div class="flex items-center justify-between max-w-7xl mx-auto">
                <div class="flex items-center gap-3 cursor-pointer" onclick="showPage('home')">
                    <svg class="w-8 h-8 text-black" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"/>
                    </svg>
                    <span class="text-xl font-bold text-black">DARK MASTER STORE</span>
                </div>
                
                <div class="flex items-center gap-3">
                    <!-- User Profile Dropdown -->
                    <div class="relative">
                        <button id="userProfileBtn" onclick="toggleUserMenu()" class="hidden p-2 hover:bg-yellow-500 rounded-lg transition">
                            <svg class="w-7 h-7 text-black" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                            </svg>
                        </button>
                        
                        <div id="userDropdownMenu" class="hidden absolute right-0 top-12 bg-white rounded-xl shadow-2xl w-80 z-50">
                            <div class="p-4 border-b bg-gradient-to-r from-yellow-400 to-yellow-500">
                                <p class="font-semibold text-sm text-gray-800">Signed in as</p>
                                <p id="userEmailDisplay" class="text-sm text-black font-bold"></p>
                            </div>
                            <div class="max-h-96 overflow-y-auto">
                                <div class="p-4">
                                    <h3 class="font-bold mb-3 flex items-center gap-2">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
                                        </svg>
                                        My Orders
                                    </h3>
                                    <div id="userOrdersList"></div>
                                </div>
                            </div>
                            <div class="p-3 border-t">
                                <button onclick="userLogout()" class="w-full text-left px-3 py-2 hover:bg-red-50 text-red-600 rounded-lg flex items-center gap-2 font-semibold">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
                                    </svg>
                                    Logout
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Cart -->
                    <button onclick="showPage('cart')" class="relative p-2 hover:bg-yellow-500 rounded-lg transition">
                        <svg class="w-7 h-7 text-black" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"/>
                        </svg>
                        <span id="cartCount" class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center font-bold hidden"></span>
                    </button>
                    
                    <!-- Sign In -->
                    <button id="signInBtn" onclick="openAuthModal('login')" class="p-2 hover:bg-yellow-500 rounded-lg transition">
                        <svg class="w-7 h-7 text-black" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"/>
                        </svg>
                    </button>
                    
                    <!-- Admin -->
                    <button onclick="showAdminLogin()" class="p-2 hover:bg-yellow-500 rounded-lg transition">
                        <svg class="w-7 h-7 text-black" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                        </svg>
                    </button>
                    
                    <!-- Mobile Menu -->
                    <button onclick="toggleMobileMenu()" class="p-2 hover:bg-yellow-500 rounded-lg transition">
                        <svg class="w-7 h-7 text-black" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile Menu -->
        <div id="mobileMenu" class="hidden bg-white shadow-lg">
            <div class="px-4 py-2 space-y-2">
                <button onclick="showPage('home')" class="block w-full text-left py-2 px-2 hover:bg-gray-100 rounded">Home</button>
                <button onclick="showPage('products')" class="block w-full text-left py-2 px-2 hover:bg-gray-100 rounded">Products</button>
                <button onclick="showPage('sellWithUs')" class="block w-full text-left py-2 px-2 hover:bg-gray-100 rounded">Sell With Us</button>
            </div>
        </div>

        <!-- HOME PAGE -->
        <div id="homePage" class="page">
            <div class="bg-yellow-400 py-16">
                <div class="max-w-4xl mx-auto px-4 text-center">
                    <h1 class="text-4xl md:text-5xl font-bold text-black mb-4">DARK MASTER STORE</h1>
                    <p class="text-xl text-gray-800 mb-8">Beauty & Gadgets for Everyday Greatness</p>
                    
                    <div class="max-w-md mx-auto mb-12">
                        <div class="flex gap-2">
                            <input id="searchInput" type="text" placeholder="Search for amazing products..." class="flex-1 px-4 py-3 rounded-lg text-lg" onkeypress="if(event.key==='Enter') searchProducts()" />
                            <button onclick="searchProducts()" class="bg-black text-yellow-400 px-6 py-3 rounded-lg font-bold hover:bg-gray-800">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                                </svg>
                            </button>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-3xl mx-auto">
                        <div class="bg-green-500 text-white rounded-full px-6 py-3 flex items-center justify-center gap-2">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path d="M9 17a2 2 0 11-4 0 2 2 0 014 0zM19 17a2 2 0 11-4 0 2 2 0 014 0z"/>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10a1 1 0 001 1h1m8-1a1 1 0 01-1 1H9m4-1V8a1 1 0 011-1h2.586a1 1 0 01.707.293l3.414 3.414a1 1 0 01.293.707V16a1 1 0 01-1 1h-1m-6-1a1 1 0 001 1h1M5 17a2 2 0 104 0m-4 0a2 2 0 114 0m6 0a2 2 0 104 0m-4 0a2 2 0 114 0"/>
                            </svg>
                            <span class="font-semibold">Free Delivery</span>
                        </div>
                        <div class="bg-white text-black rounded-full px-6 py-3 flex items-center justify-center gap-2">
                            <svg class="w-5 h-5 text-yellow-500" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                            </svg>
                            <span class="font-semibold">5â˜… Rated</span>
                        </div>
                        <div class="bg-blue-500 text-white rounded-full px-6 py-3 flex items-center justify-center gap-2">
                            <span class="text-2xl font-bold">R</span>
                            <span class="font-semibold">ZAR Currency</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Banner -->
            <div id="bannerSection" class="py-8 bg-white"></div>

            <!-- Categories -->
            <div class="py-16 bg-white">
                <div class="max-w-7xl mx-auto px-4">
                    <h2 class="text-3xl font-bold text-center mb-12">Shop by Category</h2>
                    <div id="categoriesGrid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"></div>
                </div>
            </div>

            <!-- Featured Products -->
            <div class="py-16 bg-gray-50">
                <div class="max-w-7xl mx-auto px-4">
                    <div class="flex justify-between items-center mb-8">
                        <div>
                            <h2 class="text-3xl font-bold mb-2">Featured Products</h2>
                            <p class="text-gray-600">Hand-picked favorites just for you</p>
                        </div>
                        <button onclick="showPage('products')" class="bg-yellow-400 text-black px-6 py-3 rounded-lg font-bold hover:bg-yellow-500">
                            View All Products â†’
                        </button>
                    </div>
                    <div id="featuredProducts" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
                </div>
            </div>

            <!-- More Products -->
            <div class="py-16 bg-white">
                <div class="max-w-7xl mx-auto px-4">
                    <h2 class="text-3xl font-bold text-center mb-12">Discover More</h2>
                    <div id="moreProducts" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
                    <div class="text-center mt-12">
                        <button onclick="showPage('products')" class="bg-yellow-400 text-black px-8 py-3 rounded-lg font-bold hover:bg-yellow-500 text-lg">
                            View All Products
                        </button>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div class="bg-gray-800 text-white py-12">
                <div class="max-w-7xl mx-auto px-4 grid md:grid-cols-2 gap-8">
                    <div>
                        <div class="flex items-center gap-3 mb-4">
                            <svg class="w-10 h-10 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"/>
                            </svg>
                            <h3 class="text-xl font-bold text-yellow-400">DARK MASTER STORE</h3>
                        </div>
                        <p class="text-gray-300 mb-4">Beauty & Gadgets for Everyday Greatness</p>
                        <p class="text-gray-400 text-sm">Your trusted destination for premium products across South Africa.</p>
                    </div>
                    <div>
                        <h4 class="text-yellow-400 font-semibold mb-4">Quick Links</h4>
                        <div class="space-y-2">
                            <button onclick="showPage('home')" class="block text-gray-300 hover:text-yellow-400">Home</button>
                            <button onclick="showPage('products')" class="block text-gray-300 hover:text-yellow-400">Products</button>
                            <button onclick="showPage('cart')" class="block text-gray-300 hover:text-yellow-400">Cart</button>
                        </div>
                        <h4 class="text-yellow-400 font-semibold mt-6 mb-4">Contact Us</h4>
                        <p class="text-gray-400 text-sm">Email: darkmasterstore@gmail.com</p>
                    </div>
                </div>
                <div class="border-t border-gray-700 mt-8 pt-8 text-center text-gray-400">
                    <p>&copy; 2024 Dark Master Store. All rights reserved.</p>
                </div>
            </div>
        </div>

        <!-- PRODUCTS PAGE -->
        <div id="productsPage" class="page hidden min-h-screen">
            <div class="max-w-7xl mx-auto px-4 py-8">
                <h1 class="text-3xl font-bold mb-6">All Products</h1>
                
                <div class="flex flex-col md:flex-row gap-4 mb-6">
                    <input id="productsSearchInput" type="text" placeholder="Search products..." class="flex-1 px-4 py-3 border rounded-lg" onkeyup="filterProducts()" />
                    <select id="categoryFilter" class="px-4 py-3 border rounded-lg" onchange="filterProducts()">
                        <option value="">All Categories</option>
                    </select>
                    <select id="sortFilter" class="px-4 py-3 border rounded-lg" onchange="filterProducts()">
                        <option value="newest">Newest First</option>
                        <option value="price-low">Price: Low to High</option>
                        <option value="price-high">Price: High to Low</option>
                    </select>
                </div>

                <div id="allProductsGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
            </div>
        </div>

        <!-- PRODUCT DETAIL PAGE -->
        <div id="productDetailPage" class="page hidden min-h-screen">
            <div class="max-w-7xl mx-auto px-4 py-8">
                <button onclick="showPage('products')" class="mb-6 flex items-center gap-2 text-gray-600 hover:text-black">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                    Back to Products
                </button>
                <div id="productDetailContent"></div>
            </div>
        </div>

        <!-- CART PAGE -->
        <div id="cartPage" class="page hidden min-h-screen">
            <div class="max-w-4xl mx-auto px-4 py-8">
                <h1 class="text-3xl font-bold mb-8">Shopping Cart</h1>
                <div id="cartContent"></div>
            </div>
        </div>

        <!-- CHECKOUT PAGE -->
        <div id="checkoutPage" class="page hidden min-h-screen">
            <div class="max-w-4xl mx-auto px-4 py-8">
                <button onclick="showPage('cart')" class="mb-6 flex items-center gap-2 text-gray-600 hover:text-black">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
                    </svg>
                    Back to Cart
                </button>
                <h1 class="text-3xl font-bold mb-8">Checkout</h1>
                <div id="checkoutContent"></div>
            </div>
        </div>

        <!-- SELL WITH US PAGE -->
        <div id="sellWithUsPage" class="page hidden min-h-screen">
            <div class="max-w-4xl mx-auto px-4 py-12">
                <h1 class="text-4xl font-bold text-center mb-8">Sell with Dark Master Store</h1>
                <p class="text-xl text-gray-600 text-center max-w-2xl mx-auto mb-12">
                    Join our marketplace and reach thousands of customers across South Africa.
                </p>
                
                <div class="grid md:grid-cols-4 gap-6 mb-12">
                    <div class="text-center">
                        <div class="w-16 h-16 bg-yellow-400 rounded-full flex items-center justify-center mx-auto mb-4">
                            <svg class="w-8 h-8 text-black" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                            </svg>
                        </div>
                        <h3 class="font-bold mb-2">Large Customer Base</h3>
                        <p class="text-sm text-gray-600">Thousands of active shoppers</p>
                    </div>
                    <div class="text-center">
                        <div class="w-16 h-16 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-3xl font-bold text-white">R</span>
                        </div>
                        <h3 class="font-bold mb-2">Low Commission</h3>
                        <p class="text-sm text-gray-600">Only 10% on sales</p>
                    </div>
                    <div class="text-center">
                        <div class="w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center mx-auto mb-4">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path d="M9 17a2 2 0 11-4 0 2 2 0 014 0zM19 17a2 2 0 11-4 0 2 2 0 014 0z"/>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16V6a1 1 0 00-1-1H4a1 1 0 00-1 1v10a1 1 0 001 1h1m8-1a1 1 0 01-1 1H9m4-1V8a1 1 0 011-1h2.586a1 1 0 01.707.293l3.414 3.414a1 1 0 01.293.707V16a1 1 0 01-1 1h-1m-6-1a1 1 0 001 1h1M5 17a2 2 0 104 0m-4 0a2 2 0 114 0m6 0a2 2 0 104 0m-4 0a2 2 0 114 0"/>
                            </svg>
                        </div>
                        <h3 class="font-bold mb-2">Easy Fulfillment</h3>
                        <p class="text-sm text-gray-600">Manage your own shipping</p>
                    </div>
                    <div class="text-center">
                        <div class="w-16 h-16 bg-purple-500 rounded-full flex items-center justify-center mx-auto mb-4">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                            </svg>
                        </div>
                        <h3 class="font-bold mb-2">Easy Setup</h3>
                        <p class="text-sm text-gray-600">Quick application process</p>
                    </div>
                </div>

                <div class="bg-white rounded-2xl shadow-lg p-8">
                    <h2 class="text-2xl font-bold text-center mb-6">Vendor Application</h2>
                    <form id="vendorForm" class="space-y-6">
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium mb-2">Business Name *</label>
                                <input required name="business_name" class="w-full px-4 py-3 border rounded-lg" placeholder="Your business name" />
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Contact Person *</label>
                                <input required name="contact_person" class="w-full px-4 py-3 border rounded-lg" placeholder="Your full name" />
                            </div>
                        </div>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium mb-2">Phone Number *</label>
                                <input required name="phone" class="w-full px-4 py-3 border rounded-lg" placeholder="+27 XX XXX XXXX" />
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">WhatsApp Number</label>
                                <input name="whatsapp" class="w-full px-4 py-3 border rounded-lg" placeholder="+27 XX XXX XXXX" />
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Email Address</label>
                            <input type="email" name="email" class="w-full px-4 py-3 border rounded-lg" placeholder="your@email.com" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Business Description *</label>
                            <textarea required name="description" rows="4" class="w-full px-4 py-3 border rounded-lg" placeholder="Tell us about your business..."></textarea>
                        </div>
                        <div class="bg-yellow-50 p-4 rounded-lg">
                            <h3 class="font-semibold mb-2">Commission Structure:</h3>
                            <p class="text-sm text-gray-700">
                                â€¢ 10% commission on all sales<br/>
                                â€¢ You keep 90% of the sale price<br/>
                                â€¢ Monthly payouts via bank transfer<br/>
                                â€¢ No upfront fees
                            </p>
                        </div>
                        <button type="submit" class="w-full bg-yellow-400 text-black font-bold py-4 rounded-lg hover:bg-yellow-500 text-lg">
                            Submit Application
                        </button>
                    </form>
                </div>

                <div class="text-center mt-12">
                    <p class="text-gray-600 mb-2">Questions about becoming a vendor?</p>
                    <p class="font-semibold">WhatsApp: +27 81 809 6159</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ADMIN PANEL -->
    <div id="adminPanel" class="hidden min-h-screen bg-gray-50">
        <div class="bg-white border-b px-4 py-4 flex items-center justify-between sticky top-0 z-40 shadow">
            <button onclick="toggleAdminSidebar()" class="p-2 hover:bg-gray-100 rounded-lg">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
                </svg>
            </button>
            <h1 class="text-xl font-bold">Dark Master Admin</h1>
            <div class="w-10"></div>
        </div>

        <div id="adminSidebar" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden" onclick="event.target===this && toggleAdminSidebar()">
            <div class="w-72 h-full bg-gray-900 text-white flex flex-col">
                <div class="p-6 border-b border-gray-700 flex items-center justify-between">
                    <div>
                        <h2 class="text-xl font-bold text-yellow-400">Admin Panel</h2>
                        <p class="text-xs text-gray-400">Dark Master Store</p>
                    </div>
                    <button onclick="toggleAdminSidebar()" class="text-white hover:text-yellow-400">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                    </button>
                </div>
                
                <nav class="flex-1 p-4 space-y-2">
                    <button onclick="showAdminPage('dashboard')" class="w-full flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-800 transition">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h4a1 1 0 011 1v7a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM14 5a1 1 0 011-1h4a1 1 0 011 1v7a1 1 0 01-1 1h-4a1 1 0 01-1-1V5zM4 16a1 1 0 011-1h4a1 1 0 011 1v3a1 1 0 01-1 1H5a1 1 0 01-1-1v-3zM14 16a1 1 0 011-1h4a1 1 0 011 1v3a1 1 0 01-1 1h-4a1 1 0 01-1-1v-3z"/>
                        </svg>
                        Dashboard
                    </button>
                    <button onclick="showAdminPage('products')" class="w-full flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-800 transition">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/>
                        </svg>
                        Product Generator
                    </button>
                    <button onclick="showAdminPage('categories')" class="w-full flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-800 transition">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"/>
                        </svg>
                        Category Generator
                    </button>
                    <button onclick="showAdminPage('banners')" class="w-full flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-800 transition">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                        </svg>
                        Banner Generator
                    </button>
                    <button onclick="showAdminPage('orders')" class="w-full flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-800 transition">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"/>
                        </svg>
                        Orders & Tracking
                    </button>
                    <button onclick="showAdminPage('settings')" class="w-full flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-800 transition">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                        </svg>
                        Settings
                    </button>
                </nav>
                
                <div class="p-4 border-t border-gray-700">
                    <button onclick="adminLogout()" class="w-full flex items-center gap-3 px-4 py-3 rounded-lg text-red-400 hover:bg-red-500 hover:text-white transition">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
                        </svg>
                        Logout
                    </button>
                </div>
            </div>
        </div>

        <div id="adminContent" class="p-4 md:p-8"></div>
    </div>

    <script type="module">
        import { initializeApp as initFirebaseApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { 
            getAuth, 
            createUserWithEmailAndPassword, 
            signInWithEmailAndPassword, 
            signOut, 
            onAuthStateChanged,
            updateProfile
        } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { 
            getFirestore, 
            collection, 
            getDocs, 
            addDoc, 
            updateDoc, 
            deleteDoc, 
            doc,
            query,
            where,
            orderBy as firestoreOrderBy
        } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        import {
            getStorage,
            ref as storageRef,
            uploadBytes,
            getDownloadURL
        } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js';

        const firebaseConfig = {
            apiKey: "AIzaSyC1ucCwM7ebqN-gWHT2NmkqYdK3KZBWv5o",
            authDomain: "dark-master-store.firebaseapp.com",
            projectId: "dark-master-store",
            storageBucket: "dark-master-store.firebasestorage.app",
            messagingSenderId: "624904177118",
            appId: "1:624904177118:web:2f17119f8f8b4ecd54638c",
            measurementId: "G-5SF30SSHG2"
        };

        const app = initFirebaseApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const storage = getStorage(app);

        // ==========================================
        // HARDCODED DATA - PASTE YOUR CODE HERE
        // ==========================================
        
        window.HARDCODED_PRODUCTS = [
            {
                id: 'prod_001',
                name: 'Premium Wireless Headphones',
                description: 'High-quality wireless headphones with noise cancellation and 30-hour battery life.',
                price: 899.99,
                original_price: 1299.99,
                category_id: 'cat_electronics',
                rating: 4.8,
                rating_count: 245,
                shipping_days: '2-3 days',
                in_stock: true,
                is_featured: true,
                is_sale: true,
                is_combo: false,
                sizes: ['One Size'],
                images: [
                    'https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=800',
                    'https://images.unsplash.com/photo-1484704849700-f032a568e944?w=800'
                ]
            },
            {
                id: 'prod_002',
                name: 'Luxury Skincare Combo Pack',
                description: '4-piece premium skincare set including cleanser, toner, serum, and moisturizer.',
                price: 1499.99,
                original_price: 2199.99,
                category_id: 'cat_beauty',
                rating: 4.9,
                rating_count: 389,
                shipping_days: '1-2 days',
                in_stock: true,
                is_featured: true,
                is_sale: true,
                is_combo: true,
                sizes: ['Standard'],
                images: [
                    'https://images.unsplash.com/photo-1556228720-195a672e8a03?w=400',
                    'https://images.unsplash.com/photo-1570194065650-d99fb4bedf0a?w=400',
                    'https://images.unsplash.com/photo-1608248543803-ba4f8c70ae0b?w=400',
                    'https://images.unsplash.com/photo-1590736969955-71cc94901144?w=400'
                ]
            },
            {
                id: 'prod_003',
                name: 'Smart Fitness Watch',
                description: 'Track your fitness goals with heart rate monitoring, GPS, and sleep tracking.',
                price: 1299.99,
                category_id: 'cat_electronics',
                rating: 4.7,
                rating_count: 512,
                shipping_days: '2-4 days',
                in_stock: true,
                is_featured: true,
                is_sale: false,
                is_combo: false,
                sizes: ['One Size'],
                images: [
                    'https://images.unsplash.com/photo-1579586337278-3befd40fd17a?w=800'
                ]
            },
            {
                id: 'prod_004',
                name: 'Professional Makeup Brush Set',
                description: '12-piece professional makeup brush collection with premium synthetic bristles.',
                price: 599.99,
                original_price: 899.99,
                category_id: 'cat_beauty',
                rating: 4.6,
                rating_count: 187,
                shipping_days: '1-3 days',
                in_stock: true,
                is_featured: false,
                is_sale: true,
                is_combo: false,
                sizes: ['Standard'],
                images: [
                    'https://images.unsplash.com/photo-1596462502278-27bfdc403348?w=800'
                ]
            },
            {
                id: 'prod_005',
                name: 'Portable Bluetooth Speaker',
                description: 'Waterproof portable speaker with crystal clear sound and 20-hour battery life.',
                price: 699.99,
                category_id: 'cat_electronics',
                rating: 4.5,
                rating_count: 298,
                shipping_days: '2-3 days',
                in_stock: true,
                is_featured: false,
                is_sale: false,
                is_combo: false,
                sizes: ['One Size'],
                images: [
                    'https://images.unsplash.com/photo-1608043152269-423dbba4e7e1?w=800'
                ]
            },
            {
                id: 'prod_006',
                name: 'Luxury Face Serum',
                description: 'Anti-aging serum with hyaluronic acid and vitamin C for radiant skin.',
                price: 449.99,
                category_id: 'cat_beauty',
                rating: 4.9,
                rating_count: 421,
                shipping_days: '1-2 days',
                in_stock: true,
                is_featured: true,
                is_sale: false,
                is_combo: false,
                sizes: ['30ml', '50ml'],
                images: [
                    'https://images.unsplash.com/photo-1620916566398-39f1143ab7be?w=800'
                ]
            },
            {
                id: 'prod_007',
                name: 'Gaming Mouse RGB',
                description: 'Professional gaming mouse with customizable RGB lighting and 16000 DPI.',
                price: 399.99,
                original_price: 599.99,
                category_id: 'cat_electronics',
                rating: 4.7,
                rating_count: 356,
                shipping_days: '2-3 days',
                in_stock: true,
                is_featured: false,
                is_sale: true,
                is_combo: false,
                sizes: ['One Size'],
                images: [
                    'https://images.unsplash.com/photo-1527864550417-7fd91fc51a46?w=800'
                ]
            },
            {
                id: 'prod_008',
                name: 'Hair Styling Tools Combo',
                description: 'Complete hair styling set with straightener, curler, dryer, and accessories.',
                price: 1199.99,
                category_id: 'cat_beauty',
                rating: 4.8,
                rating_count: 234,
                shipping_days: '2-4 days',
                in_stock: true,
                is_featured: false,
                is_sale: false,
                is_combo: true,
                sizes: ['Standard'],
                images: [
                    'https://images.unsplash.com/photo-1522338242992-e1a54906a8da?w=400',
                    'https://images.unsplash.com/photo-1526045478516-99145907023c?w=400',
                    'https://images.unsplash.com/photo-1616394584738-fc6e612e71b9?w=400',
                    'https://images.unsplash.com/photo-1521490878332-1defbd34dd66?w=400'
                ]
            },
            {
                id: 'prod_009',
                name: 'Mechanical Keyboard RGB',
                description: 'RGB mechanical keyboard with tactile brown switches and premium build quality.',
                price: 849.99,
                category_id: 'cat_electronics',
                rating: 4.6,
                rating_count: 189,
                shipping_days: '3-5 days',
                in_stock: true,
                is_featured: true,
                is_sale: false,
                is_combo: false,
                sizes: ['Full Size'],
                images: [
                    'https://images.unsplash.com/photo-1587829741301-dc798b83add3?w=800'
                ]
            },
            {
                id: 'prod_010',
                name: 'Organic Skincare Bundle',
                description: '5-piece organic skincare bundle with all-natural ingredients.',
                price: 799.99,
                original_price: 1199.99,
                category_id: 'cat_beauty',
                rating: 5.0,
                rating_count: 567,
                shipping_days: '1-2 days',
                in_stock: true,
                is_featured: true,
                is_sale: true,
                is_combo: true,
                sizes: ['Standard'],
                images: [
                    'https://images.unsplash.com/photo-1556228578-0d85b1a4d571?w=400',
                    'https://images.unsplash.com/photo-1571781926291-c477ebfd024b?w=400',
                    'https://images.unsplash.com/photo-1598662779094-2220f21e1d78?w=400',
                    'https://images.unsplash.com/photo-1612817288484-6f916006741a?w=400'
                ]
            }
        ];

        window.HARDCODED_CATEGORIES = [
            {
                id: 'cat_electronics',
                name: 'Electronics',
                description: 'Latest gadgets and tech',
                image: 'https://images.unsplash.com/photo-1498049794561-7780e7231661?w=400',
                order: 1
            },
            {
                id: 'cat_beauty',
                name: 'Beauty & Skincare',
                description: 'Premium beauty products',
                image: 'https://images.unsplash.com/photo-1596462502278-27bfdc403348?w=400',
                order: 2
            },

             {
                id: 'Automotive',
                 name: 'Automotive car parts ',
                 description: 'Car parts and Automotive',
                 image: 'https://i.postimg.cc/5N9w9ZFy/istockphoto-1034249292-612x612.jpg',
                  order: 3
             }

        ];

        window.HARDCODED_BANNERS = [
            {
                id: 'banner_001',
                title: 'SUMMER SALE',
                subtitle: 'Up to 50% OFF on selected items',
                image: 'https://images.unsplash.com/photo-1607082348824-0a96f2a4b9da?w=1200',
                bg_color: 'from-purple-500 to-pink-500',
                link: 'products'
            },
            {
                id: 'banner_002',
                title: 'NEW ARRIVALS',
                subtitle: 'Check out our latest collection',
                image: 'https://images.unsplash.com/photo-1441986300917-64674bd600d8?w=1200',
                bg_color: 'from-blue-500 to-cyan-500',
                link: 'products'
            },
            {
                id: 'banner_003',
                title: 'FREE SHIPPING',
                subtitle: 'On all orders this week',
                image: 'https://images.unsplash.com/photo-1607082349566-187342175e2f?w=1200',
                bg_color: 'from-green-500 to-teal-500',
                link: 'products'
            }
        ];

        // ==========================================
        // GLOBAL STATE
        // ==========================================
        
        window.appState = {
            products: [...window.HARDCODED_PRODUCTS],
            categories: [...window.HARDCODED_CATEGORIES],
            banners: [...window.HARDCODED_BANNERS],
            orders: [],
            cart: JSON.parse(localStorage.getItem('darkmaster_cart')) || [],
            currentPage: 'home',
            currentProduct: null,
            isAdmin: false,
            currentUser: null,
            currentBannerIndex: 0,
            uploadedImages: []
        };

        let revenueChart = null;

        // ==========================================
        // AUTH
        // ==========================================
        
        onAuthStateChanged(auth, (user) => {
            if (user) {
                window.appState.currentUser = user;
                document.getElementById('userProfileBtn').classList.remove('hidden');
                document.getElementById('signInBtn').classList.add('hidden');
                document.getElementById('userEmailDisplay').textContent = user.email;
                loadUserOrders();
            } else {
                window.appState.currentUser = null;
                document.getElementById('userProfileBtn').classList.add('hidden');
                document.getElementById('signInBtn').classList.remove('hidden');
            }
        });

        async function loadUserOrders() {
            if (!window.appState.currentUser) return;
            
            try {
                const q = query(
                    collection(db, 'orders'),
                    where('userId', '==', window.appState.currentUser.uid),
                    firestoreOrderBy('createdAt', 'desc')
                );
                const snapshot = await getDocs(q);
                const userOrders = snapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data()
                }));
                
                renderUserOrdersInDropdown(userOrders);
            } catch (error) {
                console.error('Error loading user orders:', error);
            }
        }

        function renderUserOrdersInDropdown(userOrders) {
            const container = document.getElementById('userOrdersList');
            if (!container) return;

            if (userOrders.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-sm text-center py-4">No orders yet</p>';
                return;
            }

            container.innerHTML = userOrders.slice(0, 3).map(order => `
                <div class="bg-gray-50 rounded-lg p-3 mb-2">
                    <div class="flex justify-between items-start mb-2">
                        <div>
                            <p class="text-xs text-gray-500">${new Date(order.createdAt).toLocaleDateString()}</p>
                            <p class="font-bold text-sm">R${order.total.toFixed(2)}</p>
                        </div>
                        ${getOrderStatusBadge(order.status)}
                    </div>
                    <p class="text-xs text-gray-600"><strong>Tracking:</strong> ${order.trackingStatus || 'Processing'}</p>
                    <p class="text-xs text-gray-500 mt-1">${order.items.length} item(s)</p>
                </div>
            `).join('');

            if (userOrders.length > 3) {
                container.innerHTML += `<p class="text-xs text-center text-gray-500 mt-2">+ ${userOrders.length - 3} more orders</p>`;
            }
        }

        window.openAuthModal = function(mode = 'login') {
            document.getElementById('authModal').classList.add('active');
            if (mode === 'login') {
                document.getElementById('loginForm').classList.remove('hidden');
                document.getElementById('registerForm').classList.add('hidden');
                document.getElementById('authModalTitle').textContent = 'Sign In';
                document.getElementById('authSwitchText').textContent = "Don't have an account?";
                document.getElementById('authSwitchBtn').textContent = 'Sign Up';
            } else {
                document.getElementById('loginForm').classList.add('hidden');
                document.getElementById('registerForm').classList.remove('hidden');
                document.getElementById('authModalTitle').textContent = 'Create Account';
                document.getElementById('authSwitchText').textContent = 'Already have an account?';
                document.getElementById('authSwitchBtn').textContent = 'Sign In';
            }
        };

        window.closeAuthModal = function() {
            document.getElementById('authModal').classList.remove('active');
            document.getElementById('authError').classList.add('hidden');
            document.getElementById('registerError').classList.add('hidden');
        };

        window.toggleAuthMode = function() {
            const isLoginMode = !document.getElementById('loginForm').classList.contains('hidden');
            openAuthModal(isLoginMode ? 'register' : 'login');
        };

        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            try {
                await signInWithEmailAndPassword(auth, formData.get('email'), formData.get('password'));
                closeAuthModal();
                showNotification('Welcome back!', 'success');
            } catch (error) {
                document.getElementById('authError').textContent = error.message;
                document.getElementById('authError').classList.remove('hidden');
            }
        });

        document.getElementById('registerForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            try {
                const userCredential = await createUserWithEmailAndPassword(auth, formData.get('email'), formData.get('password'));
                await updateProfile(userCredential.user, { displayName: formData.get('fullName') });
                closeAuthModal();
                showNotification('Account created!', 'success');
            } catch (error) {
                document.getElementById('registerError').textContent = error.message;
                document.getElementById('registerError').classList.remove('hidden');
            }
        });

        window.userLogout = async function() {
            try {
                await signOut(auth);
                toggleUserMenu();
                showNotification('Logged out successfully', 'success');
                showPage('home');
            } catch (error) {
                alert('Error: ' + error.message);
            }
        };

        window.toggleUserMenu = function() {
            document.getElementById('userDropdownMenu').classList.toggle('hidden');
        };

        document.addEventListener('click', (e) => {
            const userBtn = document.getElementById('userProfileBtn');
            const userMenu = document.getElementById('userDropdownMenu');
            if (userBtn && userMenu && !userBtn.contains(e.target) && !userMenu.contains(e.target)) {
                userMenu.classList.add('hidden');
            }
        });

        // ==========================================
        // INITIALIZATION - APP LOADS INSTANTLY
        // ==========================================
        
        async function initApp() {
            applyDailyRandomization();
            renderHomePage();
            updateCartDisplay();
            
            // Load orders in background (non-blocking)
            loadOrdersFromFirestore();
        }

        function applyDailyRandomization() {
            const dayOfYear = Math.floor((new Date() - new Date(new Date().getFullYear(), 0, 0)) / 86400000);
            
            const shuffled = [...window.appState.products];
            let seed = dayOfYear;
            for (let i = shuffled.length - 1; i > 0; i--) {
                seed = (seed * 9301 + 49297) % 233280;
                const j = Math.floor((seed / 233280) * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            window.appState.products = shuffled;
            window.appState.currentBannerIndex = dayOfYear % window.appState.banners.length;
        }

        async function loadOrdersFromFirestore() {
            try {
                const ordersSnapshot = await getDocs(collection(db, 'orders'));
                window.appState.orders = ordersSnapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data()
                }));
                console.log('Orders loaded from Firestore');
            } catch (error) {
                console.error('Error loading orders:', error);
            }
        }

        // ==========================================
        // IMAGE UPLOAD
        // ==========================================
        
        async function uploadImageToStorage(file) {
            const fileName = `products/${Date.now()}_${file.name}`;
            const fileRef = storageRef(storage, fileName);
            await uploadBytes(fileRef, file);
            return await getDownloadURL(fileRef);
        }

        window.handleProductImages = async function(files) {
            const fileList = Array.from(files);
            if (window.appState.uploadedImages.length + fileList.length > 6) {
                alert('Maximum 6 images allowed');
                return;
            }

            const uploadProgress = document.getElementById('uploadProgress');
            if (uploadProgress) uploadProgress.classList.remove('hidden');
            
            for (const file of fileList) {
                try {
                    const url = await uploadImageToStorage(file);
                    window.appState.uploadedImages.push(url);
                } catch (error) {
                    console.error('Upload error:', error);
                    alert('Failed to upload: ' + file.name);
                }
            }
            
            if (uploadProgress) uploadProgress.classList.add('hidden');
            renderImagePreviews();
        };

        function renderImagePreviews() {
            const container = document.getElementById('imagePreviewsContainer');
            if (!container) return;
            
            container.innerHTML = window.appState.uploadedImages.map((url, index) => `
                <div class="image-preview-item">
                    <img src="${url}" class="image-preview-img" alt="Preview ${index + 1}" />
                    <button type="button" onclick="removeUploadedImage(${index})" class="image-preview-remove">Ã—</button>
                </div>
            `).join('');
        }

        window.removeUploadedImage = function(index) {
            window.appState.uploadedImages.splice(index, 1);
            renderImagePreviews();
        };

        // ==========================================
        // RENDER FUNCTIONS
        // ==========================================
        
        function renderHomePage() {
            renderBanner();
            
            const categoriesGrid = document.getElementById('categoriesGrid');
            categoriesGrid.innerHTML = window.appState.categories.map(cat => `
                <div class="category-card bg-white rounded-2xl shadow-lg overflow-hidden" onclick="filterByCategory('${cat.id}')">
                    <div class="relative aspect-square">
                        <img src="${cat.image}" alt="${cat.name}" class="w-full h-full object-cover" />
                        <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                        <div class="absolute bottom-0 left-0 right-0 p-4 text-white">
                            <h3 class="font-bold text-lg">${cat.name}</h3>
                            ${cat.description ? `<p class="text-sm opacity-90 mt-1">${cat.description}</p>` : ''}
                        </div>
                    </div>
                </div>
            `).join('');

            const featuredProducts = window.appState.products.filter(p => p.is_featured).slice(0, 8);
            renderProductGrid('featuredProducts', featuredProducts);

            const moreProducts = window.appState.products.filter(p => !p.is_featured).slice(0, 4);
            renderProductGrid('moreProducts', moreProducts);
        }

        function renderBanner() {
            const bannerSection = document.getElementById('bannerSection');
            const currentBanner = window.appState.banners[window.appState.currentBannerIndex];
            
            bannerSection.innerHTML = `
                <div class="max-w-7xl mx-auto px-4">
                    <div class="banner-slide bg-gradient-to-r ${currentBanner.bg_color} rounded-3xl overflow-hidden shadow-2xl">
                        <div class="grid md:grid-cols-2 gap-8 items-center p-8 md:p-12">
                            <div class="text-white">
                                <h2 class="text-4xl md:text-5xl font-bold mb-4">${currentBanner.title}</h2>
                                <p class="text-xl mb-6">${currentBanner.subtitle}</p>
                                <button onclick="showPage('${currentBanner.link}')" class="bg-white text-black px-8 py-4 rounded-lg font-bold hover:bg-gray-100 transition">
                                    Shop Now â†’
                                </button>
                            </div>
                            <div class="hidden md:block">
                                <img src="${currentBanner.image}" alt="${currentBanner.title}" class="rounded-2xl shadow-xl" />
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderProductGrid(containerId, products) {
            const container = document.getElementById(containerId);
            if (!container) return;

            if (products.length === 0) {
                container.innerHTML = '<p class="text-gray-600 text-center col-span-full">No products found</p>';
                return;
            }

            container.innerHTML = products.map(product => createProductCard(product)).join('');
        }

        function createProductCard(product) {
            const price = product.price || 0;
            const originalPrice = product.original_price;
            const rating = product.rating || 5;
            const reviewCount = product.rating_count || 0;
            const images = product.images || [];
            const mainImage = images[0] || 'https://images.unsplash.com/photo-1572635196237-14b3f281503f?w=400';
            const isCombo = product.is_combo && images.length >= 4;

            let badgesHTML = '';
            if (product.is_sale) {
                badgesHTML += '<div class="absolute top-3 left-3 bg-red-500 text-white px-3 py-1 rounded-full text-sm font-bold">SALE</div>';
            }
            if (product.is_combo) {
                badgesHTML += `<div class="absolute ${product.is_sale ? 'top-12' : 'top-3'} left-3 bg-green-500 text-white px-3 py-1 rounded-full text-sm font-bold">COMBO</div>`;
            }
            if (!product.in_stock) {
                badgesHTML += '<div class="absolute top-3 right-3 bg-gray-800 text-white px-3 py-1 rounded-full text-sm font-bold">OUT OF STOCK</div>';
            }

            const imageHTML = isCombo ? `
                <div class="combo-image-grid">
                    <img src="${images[0]}" alt="${product.name}" />
                    <img src="${images[1]}" alt="${product.name}" />
                    <img src="${images[2]}" alt="${product.name}" />
                    <img src="${images[3]}" alt="${product.name}" />
                </div>
            ` : `
                <img src="${mainImage}" alt="${product.name}" class="w-full h-full object-cover" />
            `;

            return `
                <div class="product-card bg-white rounded-2xl shadow-lg overflow-hidden ${!product.in_stock ? 'opacity-75' : ''}">
                    <div class="relative aspect-square" onclick="showProductDetail('${product.id}')">
                        ${imageHTML}
                        ${badgesHTML}
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-lg mb-2 line-clamp-2">${product.name}</h3>
                        <div class="flex items-center gap-2 mb-3">
                            <div class="flex">
                                ${[...Array(5)].map((_, i) => `
                                    <svg class="w-4 h-4 ${i < rating ? 'text-yellow-400 fill-current' : 'text-gray-300'}" viewBox="0 0 20 20">
                                        <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                                    </svg>
                                `).join('')}
                            </div>
                            <span class="text-sm text-gray-600">(${reviewCount})</span>
                        </div>
                        <div class="flex items-baseline gap-2 mb-4">
                            <span class="text-2xl font-bold">R${price.toFixed(2)}</span>
                            ${originalPrice && originalPrice > price ? `<span class="text-gray-500 line-through">R${originalPrice.toFixed(2)}</span>` : ''}
                        </div>
                        <p class="text-sm text-gray-600 mb-4">ðŸšš Ships in ${product.shipping_days || '2-5 days'}</p>
                        <div class="flex gap-2">
                            <button onclick="addToCart('${product.id}')" class="flex-1 bg-yellow-400 text-black font-bold py-3 rounded-lg hover:bg-yellow-500 transition ${!product.in_stock ? 'opacity-50 cursor-not-allowed' : ''}" ${!product.in_stock ? 'disabled' : ''}>
                                ${product.in_stock ? 'Add to Cart' : 'Out of Stock'}
                            </button>
                            <button onclick="showProductDetail('${product.id}')" class="px-4 border border-gray-300 rounded-lg hover:bg-gray-100">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        window.showProductDetail = function(productId) {
            const product = window.appState.products.find(p => p.id === productId);
            if (!product) return;

            window.appState.currentProduct = product;
            const images = product.images || [];
            const mainImage = images[0] || 'https://images.unsplash.com/photo-1572635196237-14b3f281503f?w=800';

            const content = `
                <div class="grid md:grid-cols-2 gap-8">
                    <div>
                        <div class="aspect-square bg-gray-100 rounded-2xl mb-4 overflow-hidden">
                            <img id="mainProductImage" src="${mainImage}" alt="${product.name}" class="w-full h-full object-cover" />
                        </div>
                        ${images.length > 1 ? `
                            <div class="grid grid-cols-5 gap-2">
                                ${images.map((img, i) => `
                                    <button onclick="document.getElementById('mainProductImage').src='${img}'" 
                                            class="aspect-square rounded-lg overflow-hidden border-2 hover:border-yellow-400 transition">
                                        <img src="${img}" alt="Thumbnail ${i+1}" class="w-full h-full object-cover" />
                                    </button>
                                `).join('')}
                            </div>
                        ` : ''}
                    </div>
                    <div>
                        <h1 class="text-3xl font-bold mb-4">${product.name}</h1>
                        ${product.is_combo ? '<div class="inline-block bg-green-500 text-white px-4 py-2 rounded-full text-sm font-bold mb-4">COMBO DEAL</div>' : ''}
                        ${product.is_sale ? '<div class="inline-block bg-red-500 text-white px-4 py-2 rounded-full text-sm font-bold mb-4 ml-2">ON SALE</div>' : ''}
                        ${!product.in_stock ? '<div class="inline-block bg-gray-800 text-white px-4 py-2 rounded-full text-sm font-bold mb-4 ml-2">OUT OF STOCK</div>' : ''}
                        <div class="flex items-center gap-2 mb-4">
                            <div class="flex">
                                ${[...Array(5)].map((_, i) => `
                                    <svg class="w-5 h-5 ${i < (product.rating || 5) ? 'text-yellow-400 fill-current' : 'text-gray-300'}" viewBox="0 0 20 20">
                                        <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                                    </svg>
                                `).join('')}
                            </div>
                            <span class="text-gray-600">(${product.rating_count || 0} reviews)</span>
                        </div>
                        <div class="flex items-baseline gap-4 mb-6">
                            <span class="text-4xl font-bold">R${(product.price || 0).toFixed(2)}</span>
                            ${product.original_price && product.original_price > product.price ? `
                                <span class="text-xl text-gray-500 line-through">R${product.original_price.toFixed(2)}</span>
                            ` : ''}
                        </div>
                        <p class="text-gray-700 mb-6">${product.description || ''}</p>
                        ${product.sizes && product.sizes.length > 0 ? `
                            <div class="mb-6">
                                <h3 class="font-semibold mb-2">Select Size:</h3>
                                <div class="flex gap-2 flex-wrap">
                                    ${product.sizes.map(size => `
                                        <button onclick="window.selectedSize='${size}'; this.parentElement.querySelectorAll('button').forEach(b => b.classList.remove('bg-black', 'text-white')); this.classList.add('bg-black', 'text-white')" 
                                                class="px-4 py-2 border rounded-lg hover:border-black">
                                            ${size}
                                        </button>
                                    `).join('')}
                                </div>
                            </div>
                        ` : ''}
                        ${product.in_stock ? `
                            <div class="flex items-center gap-4 mb-6">
                                <span class="font-semibold">Quantity:</span>
                                <div class="flex items-center border rounded-lg">
                                    <button onclick="let q=document.getElementById('qty'); q.value=Math.max(1, parseInt(q.value)-1)" class="px-4 py-2 hover:bg-gray-100">-</button>
                                    <input id="qty" type="number" value="1" min="1" class="w-16 text-center border-x py-2" />
                                    <button onclick="let q=document.getElementById('qty'); q.value=parseInt(q.value)+1" class="px-4 py-2 hover:bg-gray-100">+</button>
                                </div>
                            </div>
                            <button onclick="addToCart('${product.id}', parseInt(document.getElementById('qty').value))" 
                                    class="w-full bg-yellow-400 text-black font-bold py-4 rounded-lg hover:bg-yellow-500 text-lg">
                                Add to Cart
                            </button>
                        ` : `
                            <div class="p-6 bg-gray-100 rounded-lg text-center">
                                <p class="text-lg font-semibold text-gray-700">Currently Out of Stock</p>
                            </div>
                        `}
                    </div>
                </div>
            `;

            document.getElementById('productDetailContent').innerHTML = content;
            showPage('productDetail');
        };

        window.addToCart = function(productId, quantity = 1) {
            const product = window.appState.products.find(p => p.id === productId);
            if (!product || !product.in_stock) return;

            const existingItem = window.appState.cart.find(item => item.id === productId);
            
            if (existingItem) {
                existingItem.quantity += quantity;
            } else {
                window.appState.cart.push({
                    id: product.id,
                    name: product.name,
                    price: product.price,
                    image: product.images?.[0] || '',
                    quantity: quantity
                });
            }

            localStorage.setItem('darkmaster_cart', JSON.stringify(window.appState.cart));
            updateCartDisplay();
            showNotification(`${product.name} added to cart!`, 'success');
        };

        function updateCartDisplay() {
            const count = window.appState.cart.reduce((sum, item) => sum + item.quantity, 0);
            const cartCount = document.getElementById('cartCount');
            if (cartCount) {
                cartCount.textContent = count;
                cartCount.classList.toggle('hidden', count === 0);
            }
        }

        function renderCartPage() {
            const cartContent = document.getElementById('cartContent');
            
            if (window.appState.cart.length === 0) {
                cartContent.innerHTML = `
                    <div class="text-center py-16">
                        <h2 class="text-2xl font-bold mb-4">Your Cart is Empty</h2>
                        <p class="text-gray-600 mb-8">Discover amazing products!</p>
                        <button onclick="showPage('products')" class="bg-yellow-400 text-black px-8 py-3 rounded-lg font-bold hover:bg-yellow-500">
                            Start Shopping
                        </button>
                    </div>
                `;
                return;
            }

            const subtotal = window.appState.cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);

            cartContent.innerHTML = `
                <div class="grid lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-2 space-y-4">
                        ${window.appState.cart.map(item => `
                            <div class="bg-white p-4 rounded-lg shadow flex items-center gap-4">
                                <img src="${item.image}" alt="${item.name}" class="w-20 h-20 object-cover rounded-md" />
                                <div class="flex-1">
                                    <h3 class="font-semibold">${item.name}</h3>
                                    <p class="text-gray-600">R${item.price.toFixed(2)}</p>
                                </div>
                                <div class="flex items-center gap-2">
                                    <button onclick="updateCartQuantity('${item.id}', ${item.quantity - 1})" class="px-3 py-1 border rounded hover:bg-gray-100">-</button>
                                    <span class="font-medium w-8 text-center">${item.quantity}</span>
                                    <button onclick="updateCartQuantity('${item.id}', ${item.quantity + 1})" class="px-3 py-1 border rounded hover:bg-gray-100">+</button>
                                </div>
                                <div class="text-right">
                                    <p class="font-semibold">R${(item.price * item.quantity).toFixed(2)}</p>
                                    <button onclick="removeFromCart('${item.id}')" class="text-red-500 text-sm hover:text-red-700">Remove</button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow h-fit">
                        <h2 class="text-xl font-semibold mb-4">Order Summary</h2>
                        <div class="space-y-3 mb-6">
                            <div class="flex justify-between">
                                <span>Subtotal</span>
                                <span>R${subtotal.toFixed(2)}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Shipping</span>
                                <span class="text-green-600 font-medium">FREE</span>
                            </div>
                            <div class="border-t pt-3 flex justify-between font-semibold text-lg">
                                <span>Total</span>
                                <span>R${subtotal.toFixed(2)}</span>
                            </div>
                        </div>
                        <button onclick="proceedToCheckout()" class="w-full bg-green-500 text-white font-bold py-3 rounded-lg hover:bg-green-600">
                            Proceed to Checkout
                        </button>
                    </div>
                </div>
            `;
        }

        window.updateCartQuantity = function(productId, newQuantity) {
            if (newQuantity <= 0) {
                removeFromCart(productId);
                return;
            }

            const item = window.appState.cart.find(i => i.id === productId);
            if (item) {
                item.quantity = newQuantity;
                localStorage.setItem('darkmaster_cart', JSON.stringify(window.appState.cart));
                updateCartDisplay();
                renderCartPage();
            }
        };

        window.removeFromCart = function(productId) {
            window.appState.cart = window.appState.cart.filter(item => item.id !== productId);
            localStorage.setItem('darkmaster_cart', JSON.stringify(window.appState.cart));
            updateCartDisplay();
            renderCartPage();
        };

        window.proceedToCheckout = function() {
            if (!window.appState.currentUser) {
                showNotification('Please sign in to checkout', 'error');
                openAuthModal('login');
                return;
            }
            showPage('checkout');
            renderCheckoutPage();
        };

        function renderCheckoutPage() {
            const checkoutContent = document.getElementById('checkoutContent');
            const subtotal = window.appState.cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);

            checkoutContent.innerHTML = `
                <div class="grid lg:grid-cols-2 gap-8">
                    <div class="bg-white rounded-2xl shadow-lg p-6">
                        <h2 class="text-2xl font-bold mb-6">Shipping Information</h2>
                        <form id="checkoutForm" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium mb-2">Full Name *</label>
                                <input required name="fullName" value="${window.appState.currentUser?.displayName || ''}" class="w-full px-4 py-3 border rounded-lg" placeholder="Enter your full name" />
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Phone Number *</label>
                                <input required name="phone" class="w-full px-4 py-3 border rounded-lg" placeholder="Enter your phone number" />
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Email Address</label>
                                <input type="email" name="email" value="${window.appState.currentUser?.email || ''}" class="w-full px-4 py-3 border rounded-lg" readonly />
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Street Address *</label>
                                <input required name="address" class="w-full px-4 py-3 border rounded-lg" placeholder="Enter your full address" />
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium mb-2">City *</label>
                                    <input required name="city" class="w-full px-4 py-3 border rounded-lg" placeholder="Enter your city" />
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-2">Postal Code</label>
                                    <input name="postalCode" class="w-full px-4 py-3 border rounded-lg" placeholder="Enter postal code" />
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Province *</label>
                                <select required name="province" class="w-full px-4 py-3 border rounded-lg">
                                    <option value="">Select Province</option>
                                    <option value="Gauteng">Gauteng</option>
                                    <option value="Western Cape">Western Cape</option>
                                    <option value="KwaZulu-Natal">KwaZulu-Natal</option>
                                    <option value="Eastern Cape">Eastern Cape</option>
                                    <option value="Free State">Free State</option>
                                    <option value="Mpumalanga">Mpumalanga</option>
                                    <option value="Limpopo">Limpopo</option>
                                    <option value="North West">North West</option>
                                    <option value="Northern Cape">Northern Cape</option>
                                </select>
                            </div>
                        </form>
                    </div>

                    <div class="space-y-6">
                        <div class="bg-white rounded-2xl shadow-lg p-6">
                            <h2 class="text-xl font-semibold mb-4">Order Summary</h2>
                            ${window.appState.cart.map(item => `
                                <div class="flex justify-between items-center py-2">
                                    <div>
                                        <p class="font-medium">${item.name}</p>
                                        <p class="text-sm text-gray-600">Qty: ${item.quantity}</p>
                                    </div>
                                    <p class="font-semibold">R${(item.price * item.quantity).toFixed(2)}</p>
                                </div>
                            `).join('')}
                            <div class="border-t pt-4 mt-4 space-y-2">
                                <div class="flex justify-between">
                                    <span>Subtotal</span>
                                    <span>R${subtotal.toFixed(2)}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Shipping</span>
                                    <span class="text-green-600 font-medium">FREE</span>
                                </div>
                                <div class="flex justify-between font-semibold text-lg pt-2 border-t">
                                    <span>Total</span>
                                    <span>R${subtotal.toFixed(2)}</span>
                                </div>
                            </div>
                        </div>

                        <div class="bg-gradient-to-r from-blue-500 to-blue-600 rounded-2xl shadow-lg p-6 text-white">
                            <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
                                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M20.067 8.478c.492.88.556 2.014.3 3.327-.74 3.806-3.276 5.12-6.514 5.12h-.5a.805.805 0 00-.794.68l-.04.22-.63 3.993-.03.17a.804.804 0 01-.794.68H7.78a.483.483 0 01-.477-.558L7.4 21.3l.65-4.133.04-.219a.805.805 0 01.794-.68h.5c3.238 0 5.774-1.314 6.514-5.12.256-1.313.192-2.447-.3-3.327z"/>
                                </svg>
                                Pay with PayPal
                            </h2>
                            <p class="text-sm mb-6 opacity-90">Secure checkout with PayPal</p>
                            <div id="paypal-button-container"></div>
                        </div>
                    </div>
                </div>
            `;

            initializePayPal(subtotal);
        }

        function initializePayPal(amount) {
            if (!window.paypal) {
                console.error('PayPal SDK not loaded');
                return;
            }

            paypal.Buttons({
                createOrder: function(data, actions) {
                    const form = document.getElementById('checkoutForm');
                    if (!form.checkValidity()) {
                        form.reportValidity();
                        return;
                    }

                    return actions.order.create({
                        purchase_units: [{
                            amount: {
                                value: amount.toFixed(2),
                                currency_code: 'USD'
                            },
                            description: `Dark Master Store Order - ${window.appState.cart.length} items`
                        }]
                    });
                },
                onApprove: function(data, actions) {
                    return actions.order.capture().then(function(details) {
                        completeOrder(details);
                    });
                },
                onError: function(err) {
                    console.error('PayPal error:', err);
                    showNotification('Payment failed. Please try again.', 'error');
                }
            }).render('#paypal-button-container');
        }

        async function completeOrder(paymentDetails) {
            const form = document.getElementById('checkoutForm');
            const formData = new FormData(form);
            
            const orderData = {
                userId: window.appState.currentUser.uid,
                userEmail: window.appState.currentUser.email,
                fullName: formData.get('fullName'),
                phone: formData.get('phone'),
                address: formData.get('address'),
                city: formData.get('city'),
                province: formData.get('province'),
                postalCode: formData.get('postalCode'),
                items: window.appState.cart,
                total: window.appState.cart.reduce((sum, item) => sum + (item.price * item.quantity), 0),
                status: 'pending',
                trackingStatus: 'Order Received - Processing Payment',
                paymentDetails: paymentDetails,
                paymentMethod: 'paypal',
                paymentStatus: 'paid',
                createdAt: new Date().toISOString()
            };

            try {
                await addDoc(collection(db, 'orders'), orderData);
                
                window.appState.cart = [];
                localStorage.removeItem('darkmaster_cart');
                updateCartDisplay();
                
                showNotification('Order placed successfully! Check your email for confirmation.', 'success');
                showPage('home');
                
                loadOrdersFromFirestore();
            } catch (error) {
                console.error('Error creating order:', error);
                showNotification('Error creating order. Please contact support.', 'error');
            }
        }

        window.filterByCategory = function(categoryId) {
            document.getElementById('categoryFilter').value = categoryId;
            showPage('products');
            filterProducts();
        };

        window.searchProducts = function() {
            const query = document.getElementById('searchInput').value;
            document.getElementById('productsSearchInput').value = query;
            showPage('products');
            filterProducts();
        };

        window.filterProducts = function() {
            const searchQuery = document.getElementById('productsSearchInput').value.toLowerCase();
            const categoryFilter = document.getElementById('categoryFilter').value;
            const sortFilter = document.getElementById('sortFilter').value;

            let filtered = [...window.appState.products];

            if (searchQuery) {
                filtered = filtered.filter(p => 
                    p.name.toLowerCase().includes(searchQuery) ||
                    (p.description && p.description.toLowerCase().includes(searchQuery))
                );
            }

            if (categoryFilter) {
                filtered = filtered.filter(p => p.category_id === categoryFilter);
            }

            if (sortFilter === 'price-low') {
                filtered.sort((a, b) => (a.price || 0) - (b.price || 0));
            } else if (sortFilter === 'price-high') {
                filtered.sort((a, b) => (b.price || 0) - (a.price || 0));
            }

            renderProductGrid('allProductsGrid', filtered);
        };

        function renderProductsPage() {
            const categoryFilter = document.getElementById('categoryFilter');
            categoryFilter.innerHTML = '<option value="">All Categories</option>' +
                window.appState.categories.map(cat => `<option value="${cat.id}">${cat.name}</option>`).join('');

            filterProducts();
        }

        window.showPage = function(pageName) {
            document.querySelectorAll('.page').forEach(page => page.classList.add('hidden'));
            
            if (pageName === 'home') {
                document.getElementById('homePage').classList.remove('hidden');
                renderHomePage();
            } else if (pageName === 'products') {
                document.getElementById('productsPage').classList.remove('hidden');
                renderProductsPage();
            } else if (pageName === 'productDetail') {
                document.getElementById('productDetailPage').classList.remove('hidden');
            } else if (pageName === 'cart') {
                document.getElementById('cartPage').classList.remove('hidden');
                renderCartPage();
            } else if (pageName === 'checkout') {
                document.getElementById('checkoutPage').classList.remove('hidden');
            } else if (pageName === 'sellWithUs') {
                document.getElementById('sellWithUsPage').classList.remove('hidden');
            }

            toggleMobileMenu(false);
        };

        window.toggleMobileMenu = function(show) {
            const menu = document.getElementById('mobileMenu');
            if (show === undefined) {
                menu.classList.toggle('hidden');
            } else {
                if (show) {
                    menu.classList.remove('hidden');
                } else {
                    menu.classList.add('hidden');
                }
            }
        };

        function showNotification(message, type = 'success') {
            const bgColor = type === 'success' ? 'bg-green-500' : 'bg-red-500';
            const notification = document.createElement('div');
            notification.className = `fixed top-20 right-4 ${bgColor} text-white px-6 py-3 rounded-lg shadow-lg z-50`;
            notification.textContent = message;
            document.body.appendChild(notification);
            setTimeout(() => notification.remove(), 3000);
        }

        // ==========================================
        // ADMIN FUNCTIONS
        // ==========================================
        
        window.showAdminLogin = function() {
            document.getElementById('adminLoginPopup').classList.remove('hidden');
        };

        window.attemptAdminLogin = function() {
            const password = document.getElementById('adminPasswordInput').value;
            const correctPassword = 'VNAXXTTM';

            if (password === correctPassword) {
                window.appState.isAdmin = true;
                document.getElementById('adminLoginPopup').classList.add('hidden');
                document.getElementById('mainStore').classList.add('hidden');
                document.getElementById('adminPanel').classList.remove('hidden');
                showAdminPage('dashboard');
            } else {
                const error = document.getElementById('adminLoginError');
                error.textContent = 'Invalid password. Please try again.';
                error.classList.remove('hidden');
            }
        };

        window.toggleAdminSidebar = function() {
            document.getElementById('adminSidebar').classList.toggle('hidden');
        };

        window.adminLogout = function() {
            window.appState.isAdmin = false;
            document.getElementById('adminPanel').classList.add('hidden');
            document.getElementById('mainStore').classList.remove('hidden');
            showPage('home');
        };

        window.showAdminPage = function(pageName) {
            toggleAdminSidebar();
            
            if (pageName === 'dashboard') {
                renderAdminDashboard();
            } else if (pageName === 'products') {
                renderAdminProducts();
            } else if (pageName === 'categories') {
                renderAdminCategories();
            } else if (pageName === 'banners') {
                renderAdminBanners();
            } else if (pageName === 'orders') {
                renderAdminOrders();
            } else if (pageName === 'settings') {
                renderAdminSettings();
            }
        };

        function renderAdminDashboard() {
            const totalOrders = window.appState.orders.length;
            const totalRevenue = window.appState.orders.reduce((sum, order) => sum + (order.total || 0), 0);
            const pendingOrders = window.appState.orders.filter(o => o.status === 'pending').length;
            const paidOrders = window.appState.orders.filter(o => o.paymentStatus === 'paid').length;

            const monthlyData = {};
            window.appState.orders.forEach(order => {
                const date = new Date(order.createdAt);
                const monthKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;
                if (!monthlyData[monthKey]) monthlyData[monthKey] = 0;
                monthlyData[monthKey] += order.total || 0;
            });

            const sortedMonths = Object.keys(monthlyData).sort().slice(-12);
            const monthLabels = sortedMonths.map(m => {
                const [year, month] = m.split('-');
                return new Date(year, month - 1).toLocaleDateString('en', { month: 'short' });
            });
            const monthRevenues = sortedMonths.map(m => monthlyData[m]);

            document.getElementById('adminContent').innerHTML = `
                <h1 class="text-3xl font-bold mb-8">Dashboard & Income Tracking</h1>
                
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="bg-white rounded-2xl shadow-lg p-6 cursor-pointer" onclick="showAdminPage('orders')">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-gray-600 font-medium">Total Orders</h3>
                            <svg class="w-8 h-8 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"/>
                            </svg>
                        </div>
                        <p class="text-3xl font-bold">${totalOrders}</p>
                        <p class="text-sm text-yellow-600 mt-2">${pendingOrders} pending</p>
                    </div>
                    <div class="bg-white rounded-2xl shadow-lg p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-gray-600 font-medium">Total Revenue</h3>
                            <svg class="w-8 h-8 text-yellow-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                        </div>
                        <p class="text-3xl font-bold">R${totalRevenue.toFixed(2)}</p>
                        <p class="text-sm text-green-600 mt-2">${paidOrders} paid</p>
                    </div>
                    <div class="bg-white rounded-2xl shadow-lg p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-gray-600 font-medium">Products</h3>
                            <svg class="w-8 h-8 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/>
                            </svg>
                        </div>
                        <p class="text-3xl font-bold">${window.appState.products.length}</p>
                        <p class="text-sm text-gray-500 mt-2">Hardcoded</p>
                    </div>
                    <div class="bg-white rounded-2xl shadow-lg p-6">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="text-gray-600 font-medium">Categories</h3>
                            <svg class="w-8 h-8 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"/>
                            </svg>
                        </div>
                        <p class="text-3xl font-bold">${window.appState.categories.length}</p>
                        <p class="text-sm text-gray-500 mt-2">Active</p>
                    </div>
                </div>

                <div class="bg-white rounded-2xl shadow-lg p-6">
                    <h2 class="text-2xl font-bold mb-6">Revenue Trend (Last 12 Months)</h2>
                    <canvas id="revenueChart" style="max-height: 400px;"></canvas>
                </div>
            `;

            setTimeout(() => {
                const ctx = document.getElementById('revenueChart');
                if (!ctx) return;
                
                if (revenueChart) revenueChart.destroy();
                
                revenueChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: monthLabels,
                        datasets: [{
                            label: 'Revenue (ZAR)',
                            data: monthRevenues,
                            borderColor: '#fbbf24',
                            backgroundColor: 'rgba(251, 191, 36, 0.1)',
                            fill: true,
                            tension: 0.4,
                            borderWidth: 3
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: true },
                            tooltip: {
                                callbacks: {
                                    label: (context) => `R${context.parsed.y.toFixed(2)}`
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: (value) => `R${value}`
                                }
                            }
                        }
                    }
                });
            }, 100);
        }

        function renderAdminProducts() {
            document.getElementById('adminContent').innerHTML = `
                <h1 class="text-3xl font-bold mb-6">Product Code Generator</h1>
                
                <div class="bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl p-6 mb-8">
                    <h2 class="text-xl font-bold mb-3">How It Works:</h2>
                    <ol class="space-y-2 text-sm">
                        <li class="flex items-start gap-2">
                            <span class="font-bold">1.</span>
                            <span>Fill out the product form below</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="font-bold">2.</span>
                            <span>Product gets saved to Firestore (for backup)</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="font-bold">3.</span>
                            <span>Copy the generated HTML code</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="font-bold">4.</span>
                            <span>Paste it into the <code class="bg-blue-700 px-2 py-1 rounded">window.HARDCODED_PRODUCTS</code> array</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <span class="font-bold">5.</span>
                            <span>Your product appears INSTANTLY on the store!</span>
                        </li>
                    </ol>
                </div>

                <form id="productCodeGenForm" class="bg-white rounded-2xl shadow-lg p-8 space-y-6">
                    <div>
                        <label class="block text-sm font-medium mb-2">Product ID (unique) *</label>
                        <input required name="id" class="w-full px-4 py-3 border rounded-lg" placeholder="prod_011" />
                    </div>

                    <div>
                        <label class="block text-sm font-medium mb-2">Product Images *</label>
                        <div class="upload-btn-wrapper">
                            <label class="upload-btn cursor-pointer">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                                </svg>
                                Upload Images (Max 6)
                                <input type="file" accept="image/*" multiple onchange="handleProductImages(this.files)" />
                            </label>
                        </div>
                        <p id="uploadProgress" class="hidden text-blue-600 mt-2 font-semibold">Uploading to Firebase Storage...</p>
                        <div id="imagePreviewsContainer" class="image-preview-grid"></div>
                        <p class="text-sm text-gray-600 mt-2">For COMBO: Upload at least 4 images</p>
                    </div>

                    <div>
                        <label class="block text-sm font-medium mb-2">Product Name *</label>
                        <input required name="name" class="w-full px-4 py-3 border rounded-lg" placeholder="Enter product name" />
                    </div>

                    <div>
                        <label class="block text-sm font-medium mb-2">Description</label>
                        <textarea name="description" rows="4" class="w-full px-4 py-3 border rounded-lg" placeholder="Enter product description"></textarea>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Price (ZAR) *</label>
                            <input required type="number" step="0.01" name="price" class="w-full px-4 py-3 border rounded-lg" placeholder="0.00" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Original Price (ZAR)</label>
                            <input type="number" step="0.01" name="original_price" class="w-full px-4 py-3 border rounded-lg" placeholder="0.00" />
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium mb-2">Category ID *</label>
                        <select required name="category_id" class="w-full px-4 py-3 border rounded-lg">
                            <option value="">Select category</option>
                            ${window.appState.categories.map(cat => `<option value="${cat.id}">${cat.name}</option>`).join('')}
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-medium mb-2">Sizes (comma separated, e.g., S, M, L, XL)</label>
                        <input name="sizes" class="w-full px-4 py-3 border rounded-lg" placeholder="One Size" />
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Rating (1-5)</label>
                            <input type="number" min="1" max="5" step="0.1" name="rating" value="5" class="w-full px-4 py-3 border rounded-lg" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-2">Rating Count</label>
                            <input type="number" min="0" name="rating_count" value="0" class="w-full px-4 py-3 border rounded-lg" />
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium mb-2">Shipping Days</label>
                        <input name="shipping_days" value="2-3 days" class="w-full px-4 py-3 border rounded-lg" placeholder="2-3 days" />
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <label class="flex items-center gap-3 p-4 border-2 rounded-lg cursor-pointer hover:bg-gray-50 border-green-500">
                            <input type="checkbox" name="in_stock" checked class="w-5 h-5" />
                            <div>
                                <span class="font-medium">In Stock</span>
                                <p class="text-xs text-gray-600">Product available for purchase</p>
                            </div>
                        </label>
                        
                        <label class="flex items-center gap-3 p-4 border rounded-lg cursor-pointer hover:bg-gray-50">
                            <input type="checkbox" name="is_featured" class="w-5 h-5" />
                            <div>
                                <span class="font-medium">Featured on Main</span>
                                <p class="text-xs text-gray-600">Show on homepage</p>
                            </div>
                        </label>
                        
                        <label class="flex items-center gap-3 p-4 border rounded-lg cursor-pointer hover:bg-gray-50">
                            <input type="checkbox" name="is_sale" class="w-5 h-5" />
                            <div>
                                <span class="font-medium">On Sale</span>
                                <p class="text-xs text-gray-600">Show RED "SALE" badge</p>
                            </div>
                        </label>
                        
                        <label class="flex items-center gap-3 p-4 border-2 border-green-500 rounded-lg cursor-pointer hover:bg-green-50">
                            <input type="checkbox" name="is_combo" class="w-5 h-5" />
                            <div>
                                <span class="font-medium text-green-700">âœ¨ COMBO Deal</span>
                                <p class="text-xs text-green-600">Show GREEN badge + 4 images grid</p>
                            </div>
                        </label>
                    </div>

                    <button type="submit" class="w-full bg-yellow-400 text-black px-6 py-3 rounded-lg font-bold hover:bg-yellow-500 text-lg">
                        Generate Product Code
                    </button>
                </form>

                <div id="generatedCodeSection" class="hidden mt-8 bg-white rounded-2xl shadow-lg p-8">
                    <h2 class="text-2xl font-bold mb-4 text-green-600">âœ“ Product Saved to Firestore!</h2>
                    <p class="text-gray-700 mb-4">Copy the code below and paste it into your <code class="bg-gray-100 px-2 py-1 rounded">window.HARDCODED_PRODUCTS</code> array:</p>
                    <div class="code-block">
                        <button onclick="copyGeneratedCode()" class="copy-code-btn">Copy Code</button>
                        <pre id="generatedCode"></pre>
                    </div>
                    <button onclick="showAdminPage('products')" class="mt-6 bg-gray-800 text-white px-6 py-3 rounded-lg font-bold hover:bg-gray-700">
                        Back to Products
                    </button>
                </div>
            `;

            window.appState.uploadedImages = [];

            document.getElementById('productCodeGenForm').onsubmit = async function(e) {
                e.preventDefault();
                const btn = e.target.querySelector('[type="submit"]');
                btn.disabled = true;
                btn.textContent = 'Generating...';

                const formData = new FormData(e.target);
                const sizesInput = formData.get('sizes');
                const sizes = sizesInput ? sizesInput.split(',').map(s => s.trim()).filter(Boolean) : [];

                const productData = {
                    id: formData.get('id'),
                    name: formData.get('name'),
                    description: formData.get('description'),
                    price: parseFloat(formData.get('price')),
                    original_price: formData.get('original_price') ? parseFloat(formData.get('original_price')) : null,
                    category_id: formData.get('category_id'),
                    rating: parseFloat(formData.get('rating')) || 5,
                    rating_count: parseInt(formData.get('rating_count')) || 0,
                    shipping_days: formData.get('shipping_days'),
                    in_stock: formData.get('in_stock') === 'on',
                    is_featured: formData.get('is_featured') === 'on',
                    is_sale: formData.get('is_sale') === 'on',
                    is_combo: formData.get('is_combo') === 'on',
                    sizes: sizes,
                    images: window.appState.uploadedImages
                };

                try {
                    await addDoc(collection(db, 'products'), productData);
                    
                    const generatedCode = generateProductCode(productData);
                    document.getElementById('generatedCode').textContent = generatedCode;
                    
                    document.getElementById('productCodeGenForm').classList.add('hidden');
                    document.getElementById('generatedCodeSection').classList.remove('hidden');
                    
                    showNotification('Product code generated!', 'success');
                } catch (error) {
                    console.error('Error saving product:', error);
                    alert('Error saving product: ' + error.message);
                    btn.disabled = false;
                    btn.textContent = 'Generate Product Code';
                }
            };
        }

        function generateProductCode(product) {
            return `{
    id: '${product.id}',
    name: '${product.name}',
    description: '${product.description || ''}',
    price: ${product.price},
    ${product.original_price ? `original_price: ${product.original_price},` : ''}
    category_id: '${product.category_id}',
    rating: ${product.rating},
    rating_count: ${product.rating_count},
    shipping_days: '${product.shipping_days}',
    in_stock: ${product.in_stock},
    is_featured: ${product.is_featured},
    is_sale: ${product.is_sale},
    is_combo: ${product.is_combo},
    sizes: [${product.sizes.map(s => `'${s}'`).join(', ')}],
    images: [
        ${product.images.map(img => `'${img}'`).join(',\n        ')}
    ]
},`;
        }

        window.copyGeneratedCode = function() {
            const code = document.getElementById('generatedCode').textContent;
            navigator.clipboard.writeText(code).then(() => {
                showNotification('Code copied to clipboard!', 'success');
            });
        };

        function renderAdminCategories() {
            document.getElementById('adminContent').innerHTML = `
                <h1 class="text-3xl font-bold mb-6">Category Code Generator</h1>
                
                <div class="bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-xl p-6 mb-8">
                    <h2 class="text-xl font-bold mb-3">How It Works:</h2>
                    <ol class="space-y-2 text-sm">
                        <li>1. Add category details below</li>
                        <li>2. Category saves to Firestore</li>
                        <li>3. Copy generated code</li>
                        <li>4. Paste into <code class="bg-purple-700 px-2 py-1 rounded">window.HARDCODED_CATEGORIES</code></li>
                    </ol>
                </div>

                <form id="categoryCodeGenForm" class="bg-white rounded-2xl shadow-lg p-8 space-y-6">
                    <div>
                        <label class="block text-sm font-medium mb-2">Category ID (unique) *</label>
                        <input required name="id" class="w-full px-4 py-3 border rounded-lg" placeholder="cat_newcategory" />
                    </div>

                    <div>
                        <label class="block text-sm font-medium mb-2">Category Name *</label>
                        <input required name="name" class="w-full px-4 py-3 border rounded-lg" placeholder="Enter category name" />
                    </div>

                    <div>
                        <label class="block text-sm font-medium mb-2">Description</label>
                        <textarea name="description" rows="3" class="w-full px-4 py-3 border rounded-lg" placeholder="Enter category description"></textarea>
                    </div>

                    <div>
                        <label class="block text-sm font-medium mb-2">Image URL *</label>
                        <input required name="image" class="w-full px-4 py-3 border rounded-lg" placeholder="https://example.com/image.jpg" />
                    </div>

                    <button type="submit" class="w-full bg-purple-500 text-white px-6 py-3 rounded-lg font-bold hover:bg-purple-600 text-lg">
                        Generate Category Code
                    </button>
                </form>

                <div id="generatedCategoryCodeSection" class="hidden mt-8 bg-white rounded-2xl shadow-lg p-8">
                    <h2 class="text-2xl font-bold mb-4 text-green-600">âœ“ Category Saved!</h2>
                    <p class="text-gray-700 mb-4">Copy and paste into <code class="bg-gray-100 px-2 py-1 rounded">window.HARDCODED_CATEGORIES</code>:</p>
                    <div class="code-block">
                        <button onclick="copyGeneratedCategoryCode()" class="copy-code-btn">Copy Code</button>
                        <pre id="generatedCategoryCode"></pre>
                    </div>
                    <button onclick="showAdminPage('categories')" class="mt-6 bg-gray-800 text-white px-6 py-3 rounded-lg font-bold hover:bg-gray-700">
                        Back
                    </button>
                </div>
            `;

            document.getElementById('categoryCodeGenForm').onsubmit = async function(e) {
                e.preventDefault();
                const btn = e.target.querySelector('[type="submit"]');
                btn.disabled = true;
                btn.textContent = 'Generating...';

                const formData = new FormData(e.target);
                const categoryData = {
                    id: formData.get('id'),
                    name: formData.get('name'),
                    description: formData.get('description'),
                    image: formData.get('image'),
                    order: window.appState.categories.length + 1
                };

                try {
                    await addDoc(collection(db, 'categories'), categoryData);
                    
                    const code = `{
    id: '${categoryData.id}',
    name: '${categoryData.name}',
    description: '${categoryData.description || ''}',
    image: '${categoryData.image}',
    order: ${categoryData.order}
},`;
                    
                    document.getElementById('generatedCategoryCode').textContent = code;
                    document.getElementById('categoryCodeGenForm').classList.add('hidden');
                    document.getElementById('generatedCategoryCodeSection').classList.remove('hidden');
                    
                    showNotification('Category code generated!', 'success');
                } catch (error) {
                    alert('Error: ' + error.message);
                    btn.disabled = false;
                    btn.textContent = 'Generate Category Code';
                }
            };
        }

        window.copyGeneratedCategoryCode = function() {
            const code = document.getElementById('generatedCategoryCode').textContent;
            navigator.clipboard.writeText(code).then(() => {
                showNotification('Code copied!', 'success');
            });
        };

        function renderAdminBanners() {
            document.getElementById('adminContent').innerHTML = `
                <h1 class="text-3xl font-bold mb-6">Banner Code Generator</h1>
                
                <div class="bg-gradient-to-r from-pink-500 to-rose-500 text-white rounded-xl p-6 mb-8">
                    <h2 class="text-xl font-bold mb-3">How It Works:</h2>
                    <ol class="space-y-2 text-sm">
                        <li>1. Create banner below</li>
                        <li>2. Banner saves to Firestore</li>
                        <li>3. Copy generated code</li>
                        <li>4. Paste into <code class="bg-rose-700 px-2 py-1 rounded">window.HARDCODED_BANNERS</code></li>
                        <li>5. Banners rotate daily automatically!</li>
                    </ol>
                </div>

                <form id="bannerCodeGenForm" class="bg-white rounded-2xl shadow-lg p-8 space-y-6">
                    <div>
                        <label class="block text-sm font-medium mb-2">Banner ID (unique) *</label>
                        <input required name="id" class="w-full px-4 py-3 border rounded-lg" placeholder="banner_004" />
                    </div>

                    <div>
                        <label class="block text-sm font-medium mb-2">Title *</label>
                        <input required name="title" class="w-full px-4 py-3 border rounded-lg" placeholder="SPECIAL OFFER" />
                    </div>

                    <div>
                        <label class="block text-sm font-medium mb-2">Subtitle</label>
                        <input name="subtitle" class="w-full px-4 py-3 border rounded-lg" placeholder="Limited time only" />
                    </div>

                    <div>
                        <label class="block text-sm font-medium mb-2">Image URL *</label>
                        <input required name="image" class="w-full px-4 py-3 border rounded-lg" placeholder="https://example.com/banner.jpg" />
                    </div>

                    <div>
                        <label class="block text-sm font-medium mb-2">Gradient Colors *</label>
                        <input required name="bg_color" value="from-orange-500 to-red-500" class="w-full px-4 py-3 border rounded-lg" placeholder="from-orange-500 to-red-500" />
                        <p class="text-sm text-gray-600 mt-1">Use Tailwind gradient classes</p>
                    </div>

                    <div>
                        <label class="block text-sm font-medium mb-2">Link to Page</label>
                        <input name="link" value="products" class="w-full px-4 py-3 border rounded-lg" placeholder="products" />
                    </div>

                    <button type="submit" class="w-full bg-pink-500 text-white px-6 py-3 rounded-lg font-bold hover:bg-pink-600 text-lg">
                        Generate Banner Code
                    </button>
                </form>

                <div id="generatedBannerCodeSection" class="hidden mt-8 bg-white rounded-2xl shadow-lg p-8">
                    <h2 class="text-2xl font-bold mb-4 text-green-600">âœ“ Banner Saved!</h2>
                    <p class="text-gray-700 mb-4">Copy and paste into <code class="bg-gray-100 px-2 py-1 rounded">window.HARDCODED_BANNERS</code>:</p>
                    <div class="code-block">
                        <button onclick="copyGeneratedBannerCode()" class="copy-code-btn">Copy Code</button>
                        <pre id="generatedBannerCode"></pre>
                    </div>
                    <button onclick="showAdminPage('banners')" class="mt-6 bg-gray-800 text-white px-6 py-3 rounded-lg font-bold hover:bg-gray-700">
                        Back
                    </button>
                </div>
            `;

            document.getElementById('bannerCodeGenForm').onsubmit = async function(e) {
                e.preventDefault();
                const btn = e.target.querySelector('[type="submit"]');
                btn.disabled = true;
                btn.textContent = 'Generating...';

                const formData = new FormData(e.target);
                const bannerData = {
                    id: formData.get('id'),
                    title: formData.get('title'),
                    subtitle: formData.get('subtitle'),
                    image: formData.get('image'),
                    bg_color: formData.get('bg_color'),
                    link: formData.get('link')
                };

                try {
                    await addDoc(collection(db, 'banners'), bannerData);
                    
                    const code = `{
    id: '${bannerData.id}',
    title: '${bannerData.title}',
    subtitle: '${bannerData.subtitle}',
    image: '${bannerData.image}',
    bg_color: '${bannerData.bg_color}',
    link: '${bannerData.link}'
},`;
                    
                    document.getElementById('generatedBannerCode').textContent = code;
                    document.getElementById('bannerCodeGenForm').classList.add('hidden');
                    document.getElementById('generatedBannerCodeSection').classList.remove('hidden');
                    
                    showNotification('Banner code generated!', 'success');
                } catch (error) {
                    alert('Error: ' + error.message);
                    btn.disabled = false;
                    btn.textContent = 'Generate Banner Code';
                }
            };
        }

        window.copyGeneratedBannerCode = function() {
            const code = document.getElementById('generatedBannerCode').textContent;
            navigator.clipboard.writeText(code).then(() => {
                showNotification('Banner code copied!', 'success');
            });
        };

        function renderAdminOrders() {
            document.getElementById('adminContent').innerHTML = `
                <h1 class="text-3xl font-bold mb-8">Orders & Delivery Tracking</h1>
                <div class="bg-white rounded-2xl shadow-lg overflow-x-auto">
                    ${window.appState.orders.length === 0 ? `
                        <div class="p-12 text-center text-gray-600">
                            <p class="text-lg font-semibold">No orders yet</p>
                            <p class="text-sm mt-2">Orders will appear here once customers make purchases</p>
                        </div>
                    ` : `
                        <table class="products-table">
                            <thead>
                                <tr>
                                    <th>Order #</th>
                                    <th>Date</th>
                                    <th>Customer & Location</th>
                                    <th>Items</th>
                                    <th>Total</th>
                                    <th>Payment</th>
                                    <th>Status</th>
                                    <th>Tracking</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${window.appState.orders.map(order => `
                                    <tr>
                                        <td class="font-mono text-sm">#${order.id.substring(0, 8)}</td>
                                        <td class="text-sm">${new Date(order.createdAt).toLocaleDateString()}</td>
                                        <td>
                                            <div class="font-medium">${order.fullName}</div>
                                            <div class="text-sm text-gray-600">${order.userEmail}</div>
                                            <div class="text-sm text-gray-600">${order.phone}</div>
                                            <div class="text-xs text-gray-500 mt-1">${order.address}, ${order.city}${order.province ? ', ' + order.province : ''}</div>
                                        </td>
                                        <td>
                                            <div class="text-sm">${order.items?.length || 0} item(s)</div>
                                            <div class="flex gap-1 mt-1">
                                                ${order.items.slice(0, 3).map(item => `
                                                    <img src="${item.image}" alt="${item.name}" class="w-8 h-8 object-cover rounded" />
                                                `).join('')}
                                            </div>
                                        </td>
                                        <td class="font-semibold">R${(order.total || 0).toFixed(2)}</td>
                                        <td>
                                            <span class="px-2 py-1 rounded-full text-xs ${order.paymentStatus === 'paid' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'}">
                                                ${order.paymentStatus === 'paid' ? 'PAID' : 'PENDING'}
                                            </span>
                                        </td>
                                        <td>${getOrderStatusBadge(order.status)}</td>
                                        <td class="text-sm max-w-xs">
                                            <p class="font-medium">${order.trackingStatus || 'N/A'}</p>
                                        </td>
                                        <td>
                                            <button onclick="viewOrderDetails('${order.id}')" class="text-blue-600 hover:text-blue-800 text-sm font-semibold mr-2">View</button>
                                            <button onclick="updateOrderTracking('${order.id}')" class="text-green-600 hover:text-green-800 text-sm font-semibold">Update</button>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    `}
                </div>
            `;
        }

        function getOrderStatusBadge(status) {
            const statusConfig = {
                pending: { label: 'Pending', class: 'status-pending' },
                processing: { label: 'Processing', class: 'status-processing' },
                shipped: { label: 'Shipped', class: 'status-shipped' },
                delivered: { label: 'Delivered', class: 'status-delivered' },
                cancelled: { label: 'Cancelled', class: 'status-cancelled' }
            };
            
            const config = statusConfig[status] || statusConfig.pending;
            return `<span class="order-status-badge ${config.class}">${config.label}</span>`;
        }

        window.viewOrderDetails = function(orderId) {
            const order = window.appState.orders.find(o => o.id === orderId);
            if (!order) return;

            alert(`ðŸ“¦ ORDER DETAILS\n\n` +
                `Order ID: ${order.id}\n` +
                `Date: ${new Date(order.createdAt).toLocaleString()}\n\n` +
                `Customer: ${order.fullName}\n` +
                `Email: ${order.userEmail}\n` +
                `Phone: ${order.phone}\n` +
                `Address: ${order.address}, ${order.city}, ${order.province} ${order.postalCode}\n\n` +
                `Items:\n${order.items.map(item => `- ${item.name} (x${item.quantity}) - R${(item.price * item.quantity).toFixed(2)}`).join('\n')}\n\n` +
                `Total: R${order.total.toFixed(2)}\n` +
                `Payment: ${order.paymentStatus?.toUpperCase() || 'PENDING'}\n` +
                `Status: ${order.status}\n` +
                `Tracking: ${order.trackingStatus || 'N/A'}`
            );
        };

        window.updateOrderTracking = async function(orderId) {
            const order = window.appState.orders.find(o => o.id === orderId);
            if (!order) return;

            const newStatus = prompt('Enter order status (pending, processing, shipped, delivered, cancelled):', order.status);
            if (!newStatus) return;
            
            const validStatuses = ['pending', 'processing', 'shipped', 'delivered', 'cancelled'];
            if (!validStatuses.includes(newStatus)) {
                alert('Invalid status. Use: pending, processing, shipped, delivered, or cancelled');
                return;
            }

            const newTracking = prompt('Enter tracking message (e.g., "Your order is out for delivery"):', order.trackingStatus || '');
            if (!newTracking) return;

            try {
                await updateDoc(doc(db, 'orders', orderId), {
                    status: newStatus,
                    trackingStatus: newTracking,
                    lastUpdated: new Date().toISOString()
                });

                const orderIndex = window.appState.orders.findIndex(o => o.id === orderId);
                if (orderIndex >= 0) {
                    window.appState.orders[orderIndex].status = newStatus;
                    window.appState.orders[orderIndex].trackingStatus = newTracking;
                }

                renderAdminOrders();
                showNotification('Order tracking updated!', 'success');
            } catch (error) {
                console.error('Error updating order:', error);
                alert('Error updating order: ' + error.message);
            }
        };

        function renderAdminSettings() {
            document.getElementById('adminContent').innerHTML = `
                <h1 class="text-3xl font-bold mb-8">Settings</h1>
                <div class="max-w-2xl">
                    <form id="settingsForm" class="bg-white rounded-2xl shadow-lg p-8 space-y-6">
                        <div>
                            <label class="block text-sm font-medium mb-2">Store WhatsApp Number</label>
                            <input name="whatsapp" value="+27 81 809 6159" class="w-full px-4 py-3 border rounded-lg" placeholder="+27 XX XXX XXXX" />
                        </div>

                        <div>
                            <label class="block text-sm font-medium mb-2">Store Email</label>
                            <input name="email" value="darkmasterstore@gmail.com" class="w-full px-4 py-3 border rounded-lg" placeholder="store@email.com" />
                        </div>

                        <div>
                            <label class="block text-sm font-medium mb-2">Store Tagline</label>
                            <input name="tagline" value="Beauty & Gadgets for Everyday Greatness" class="w-full px-4 py-3 border rounded-lg" />
                        </div>

                        <div>
                            <label class="block text-sm font-medium mb-2">Admin Password</label>
                            <input type="password" name="password" value="VNAXXTTM" class="w-full px-4 py-3 border rounded-lg" />
                            <p class="text-sm text-gray-600 mt-1">Change this password for admin access</p>
                        </div>

                        <button type="submit" class="w-full bg-yellow-400 text-black px-6 py-3 rounded-lg font-bold hover:bg-yellow-500">
                            Save Settings
                        </button>
                    </form>

                    <div class="bg-blue-50 border-2 border-blue-200 rounded-xl p-6 mt-8">
                        <h3 class="font-bold text-blue-900 mb-3">ðŸ“ Important Notes:</h3>
                        <ul class="text-sm text-blue-800 space-y-2">
                            <li>â€¢ Products, categories, and banners load instantly from HTML</li>
                            <li>â€¢ Firestore only stores orders and tracking updates</li>
                            <li>â€¢ When you add products/categories/banners, copy the code and paste into HTML</li>
                            <li>â€¢ Customers see tracking updates in real-time</li>
                            <li>â€¢ Images upload to Firebase Storage for permanent URLs</li>
                        </ul>
                    </div>
                </div>
            `;

            document.getElementById('settingsForm').onsubmit = function(e) {
                e.preventDefault();
                showNotification('Settings saved successfully!', 'success');
            };
        }

        // Handle vendor form
        const vendorForm = document.getElementById('vendorForm');
        if (vendorForm) {
            vendorForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                const formData = new FormData(e.target);
                const vendorData = {
                    business_name: formData.get('business_name'),
                    contact_person: formData.get('contact_person'),
                    phone: formData.get('phone'),
                    whatsapp: formData.get('whatsapp'),
                    email: formData.get('email'),
                    description: formData.get('description'),
                    status: 'pending',
                    createdAt: new Date().toISOString()
                };

                try {
                    await addDoc(collection(db, 'vendors'), vendorData);
                    showNotification('Application submitted successfully! We\'ll contact you within 2-3 business days.', 'success');
                    e.target.reset();
                } catch (error) {
                    console.error('Error submitting vendor application:', error);
                    alert('Error submitting application: ' + error.message);
                }
            });
        }

        // Initialize app
        initApp();
    </script>
</body>
</html>
